import{_ as $}from"./IconPark.vue_vue_type_script_setup_true_lang-97721d02.js";import{d as j,C as z}from"./TableColumn-5967edef.js";import{d as A,r as u,h as i,g as a,e as t,q as K,f as n,o as s,F as y,i as b,j as w,c as m,m as _,k as O,E as V,s as G,v as H,t as P}from"./index-9b9da70b.js";const Y=A({__name:"DataManage",setup(Q){const k=localStorage.getItem("schemaList")||"[]",S=JSON.parse(k),p=u([]),f=u([]),c=u(!1),v=u([]),d=u(),g=u(),x=async o=>{g.value=o,p.value=[],K(o).then(l=>{l&&l.forEach(r=>{r&&p.value.push(r)})})},D=async o=>{o&&(f.value=o)},E=async()=>{if(f.value.length<1){V.warning("请先选择表");return}const o={configType:z.BASE};v.value=[],G(o).then(l=>{c.value=!0,l&&l.forEach(r=>{r.dataConfig&&v.value.push(r.dataConfig)})})},L=async()=>{if(!d.value){V.warning("请选择模板");return}c.value=!1,await H(g.value,d.value,f.value)};return(o,l)=>{const r=n("el-menu-item"),T=n("el-menu"),N=n("el-icon"),h=n("el-button"),C=n("el-table-column"),B=n("el-table"),F=n("el-option"),I=n("el-select"),q=n("el-form-item"),J=n("el-form"),M=n("el-dialog"),U=n("el-card");return s(),i("div",null,[a(T,{onSelect:x,mode:"horizontal"},{default:t(()=>[(s(!0),i(y,null,b(w(S),e=>(s(),m(r,{index:e.databaseId},{default:t(()=>[_(P(e.schemaName),1)]),_:2},1032,["index"]))),256))]),_:1}),a(U,null,{header:t(()=>[g.value?(s(),m(h,{key:0,type:"primary",style:{"margin-right":"10px"},onClick:E},{default:t(()=>[a(N,null,{default:t(()=>[a($,{icon:"icon-park-download"})]),_:1}),_(" 下载 ")]),_:1})):O("",!0)]),default:t(()=>[a(B,{data:p.value,style:{width:"100%"},height:"500",onSelectionChange:D},{default:t(()=>[a(C,{type:"selection",width:"55"}),(s(!0),i(y,null,b(w(j),e=>(s(),m(C,{prop:e.prop,label:e.label,width:e.width,formatter:e.formatter},null,8,["prop","label","width","formatter"]))),256))]),_:1},8,["data"]),a(M,{modelValue:c.value,"onUpdate:modelValue":l[2]||(l[2]=e=>c.value=e),title:"下载文件",width:"30%"},{footer:t(()=>[a(h,{type:"info",onClick:l[1]||(l[1]=e=>c.value=!1)},{default:t(()=>[_("取消")]),_:1}),a(h,{type:"primary",onClick:L},{default:t(()=>[_("确定")]),_:1})]),default:t(()=>[a(J,null,{default:t(()=>[a(q,{label:"模板"},{default:t(()=>[a(I,{modelValue:d.value,"onUpdate:modelValue":l[0]||(l[0]=e=>d.value=e),placeholder:"请选择模板"},{default:t(()=>[(s(!0),i(y,null,b(v.value,e=>(s(),m(F,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}});export{Y as default};
